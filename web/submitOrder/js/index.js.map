{"version":3,"file":"/web/submitOrder/js/index.js.map","sources":["/web/submitOrder/js/index.js"],"sourcesContent":["$(function() {\n  FastClick.attach(document.body);\n\n  var $sendBtn = $('.code-btn'),\n    $province = $('.province'),\n    $city = $('.city'),\n    $region = $('.region'),\n    datas = [];\n\n  //返回\n  $('header i').on('click', function() {\n    history.go(-1);\n  });\n  \n  // 发送验证码倒计时\n  function getCountDown(timer) {\n    $sendBtn.text(timer + 's后重试').addClass('disabled');\n    var setTime = setTimeout(function() {\n      if (timer === 1) {\n        $sendBtn.text('发送验证码').removeClass('disabled');\n        return;\n      }\n      timer--;\n      clearTimeout(setTime);\n      getCountDown(timer);\n    }, 1000);\n  }\n  \n  // 获取验证码\n  $sendBtn.on('click', function() {\n    if ($(this).hasClass('disabled')) {\n      return;\n    }\n\n    var phone = $('#phone').val();\n    \n    if (!phone.trim()) {\n      alert(\"请输入手机号码！\"); \n      return false; \n    } else if(!(/^1[3|4|5|7|8][0-9]\\d{4,8}$/.test(phone))){ \n      alert(\"手机号码不对！\"); \n      return false; \n    }\n   \n    $.ajax({\n      type: 'POST',\n      url: '/api/verification-codes',\n      data: { phone : phone },\n      dataType: 'json',\n      timeout: 3000,\n      success: function(data){\n        // 按钮倒计时\n        getCountDown(60);\n      },\n      error: function(data){\n        console.log(data);\n      }\n    });\n  });\n\n  // 收获地址\n  var $selectDiv = $('.selectDiv');\n\n  $('.selectVal').on('click', function(e) {\n    e.stopPropagation();\n    var $selectDiv = $(this).siblings('.selectDiv'),\n      $outlineBorder = $(this).parent('.outlineBorder');\n\n    $selectDiv.toggleClass('none');\n    if (!$selectDiv.hasClass('none')) {\n      $outlineBorder.addClass('open');\n    } else {\n      $outlineBorder.removeClass('open');\n    }\n  });\n\n  $(document).on('click', function() {\n    $selectDiv.each(function(){\n      if (!$(this).hasClass('none')) {\n        $(this).addClass('none');\n      }\n    });\n  });\n\n  $.getJSON('../common/json/areaData.json', function(data){\n    datas = data;\n    getDatasById($province, '86');\n  });\n\n  function event() {\n    $('.goods-address ul li').on('click', function() {\n      var $ele = $(this),\n        $ul = $(this).parent(),\n        text = $ele.text(),\n        val = $ele.attr('value');\n\n      $selectDiv.addClass('none');\n      $ul.siblings('.selectVal').text(text).attr('data-id', val);\n\n      if ($ul.hasClass('province')) {\n        getDatasById($city, val);\n      } else if ($ul.hasClass('city')) {\n        getDatasById($region, val);\n      }\n    });\n  }\n\n  function getDatasById($ele, id) {\n    var address = datas[id],\n      options = [];\n\n    for (var key in address) {\n      options.push('<li value=' + key + '>' + address[key] + '</li>');\n    }\n\n    $ele.html(options.join(''));\n    event();\n  }\n\n  // 微信支付\n  $('.pay-btn').on('click', function() {\n     // 调用后端接口，获取【appId，timestamp，nonceStr，signature】\n\n    function onBridgeReady(){\n      WeixinJSBridge.invoke(\n        'getBrandWCPayRequest', {\n          \"appId\":\"wx2421b1c4370ec43b\",     //公众号名称，由商户传入     \n          \"timeStamp\":\"1395712654\",         //时间戳，自1970年以来的秒数     \n          \"nonceStr\":\"e61463f8efa94090b1f366cccfbbb444\", //随机串     \n          \"package\":\"prepay_id=u802345jgfjsdfgsdg888\",     \n          \"signType\":\"MD5\",         //微信签名方式：     \n          \"paySign\":\"70EA570631E4BB79628FBCA90534C63FF7FADD89\" //微信签名 \n        },\n        function(res){\n          if(res.err_msg == \"get_brand_wcpay_request:ok\" ){\n            // 使用以上方式判断前端返回,微信团队郑重提示：\n            //res.err_msg将在用户支付成功后返回ok，但并不保证它绝对可靠。\n            location.href = '../paySuccess/index.html';\n          } \n        }\n      ); \n    }\n    if (typeof WeixinJSBridge == \"undefined\"){\n      if( document.addEventListener ){\n        document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);\n      }else if (document.attachEvent){\n        document.attachEvent('WeixinJSBridgeReady', onBridgeReady); \n        document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);\n      }\n    }else{\n      onBridgeReady();\n    }\n  });\n});"],"names":["$","getCountDown","timer","$sendBtn","text","addClass","setTime","setTimeout","removeClass","clearTimeout","event","on","$ele","this","$ul","parent","val","attr","$selectDiv","siblings","hasClass","getDatasById","$city","$region","id","address","datas","options","key","push","html","join","FastClick","attach","document","body","$province","history","go","phone","trim","test","ajax","type","url","data","dataType","timeout","success","error","console","log","alert","e","stopPropagation","$outlineBorder","toggleClass","each","getJSON","onBridgeReady","WeixinJSBridge","invoke","appId","timeStamp","nonceStr","package","signType","paySign","res","err_msg","location","href","addEventListener","attachEvent"],"mappings":"AAAAA,EAAE,WAeA,QAASC,GAAaC,GACpBC,EAASC,KAAKF,EAAQ,QAAQG,SAAS,WACvC,IAAIC,GAAUC,WAAW,WACvB,MAAc,KAAVL,MACFC,GAASC,KAAK,SAASI,YAAY,aAGrCN,IACAO,aAAaH,OACbL,GAAaC,KACZ,KAgEL,QAASQ,KACPV,EAAE,wBAAwBW,GAAG,QAAS,WACpC,GAAIC,GAAOZ,EAAEa,MACXC,EAAMd,EAAEa,MAAME,SACdX,EAAOQ,EAAKR,OACZY,EAAMJ,EAAKK,KAAK,QAElBC,GAAWb,SAAS,QACpBS,EAAIK,SAAS,cAAcf,KAAKA,GAAMa,KAAK,UAAWD,GAElDF,EAAIM,SAAS,YACfC,EAAaC,EAAON,GACXF,EAAIM,SAAS,SACtBC,EAAaE,EAASP,KAK5B,QAASK,GAAaT,EAAMY,GAC1B,GAAIC,GAAUC,EAAMF,GAClBG,IAEF,KAAK,GAAIC,KAAOH,GACdE,EAAQE,KAAK,aAAeD,EAAM,IAAMH,EAAQG,GAAO,QAGzDhB,GAAKkB,KAAKH,EAAQI,KAAK,KACvBrB,IAnHFsB,UAAUC,OAAOC,SAASC,KAE1B,IAAIhC,GAAWH,EAAE,aACfoC,EAAYpC,EAAE,aACdsB,EAAQtB,EAAE,SACVuB,EAAUvB,EAAE,WACZ0B,IAGF1B,GAAE,YAAYW,GAAG,QAAS,WACxB0B,QAAQC,GAAG,MAkBbnC,EAASQ,GAAG,QAAS,WACnB,IAAIX,EAAEa,MAAMO,SAAS,YAArB,CAIA,GAAImB,GAAQvC,EAAE,UAAUgB,KAExB,OAAKuB,GAAMC,OAGC,6BAA6BC,KAAKF,OAK9CvC,GAAE0C,MACAC,KAAM,OACNC,IAAK,0BACLC,MAAQN,MAAQA,GAChBO,SAAU,OACVC,QAAS,IACTC,QAAS,WAEP/C,EAAa,KAEfgD,MAAO,SAASJ,GACdK,QAAQC,IAAIN,OAfdO,MAAM,YACC,IAJPA,MAAM,aACC,KAuBX,IAAIlC,GAAalB,EAAE,aAEnBA,GAAE,cAAcW,GAAG,QAAS,SAAS0C,GACnCA,EAAEC,iBACF,IAAIpC,GAAalB,EAAEa,MAAMM,SAAS,cAChCoC,EAAiBvD,EAAEa,MAAME,OAAO,iBAElCG,GAAWsC,YAAY,QAClBtC,EAAWE,SAAS,QAGvBmC,EAAe/C,YAAY,QAF3B+C,EAAelD,SAAS,UAM5BL,EAAEkC,UAAUvB,GAAG,QAAS,WACtBO,EAAWuC,KAAK,WACTzD,EAAEa,MAAMO,SAAS,SACpBpB,EAAEa,MAAMR,SAAS,YAKvBL,EAAE0D,QAAQ,+BAAgC,SAASb,GACjDnB,EAAQmB,EACRxB,EAAae,EAAW,QAkC1BpC,EAAE,YAAYW,GAAG,QAAS,WAGxB,QAASgD,KACPC,eAAeC,OACb,wBACEC,MAAQ,qBACRC,UAAY,aACZC,SAAW,mCACXC,UAAU,kCACVC,SAAW,MACXC,QAAU,4CAEZ,SAASC,GACW,8BAAfA,EAAIC,UAGLC,SAASC,KAAO,8BAKK,mBAAlBX,gBACL1B,SAASsC,iBACXtC,SAASsC,iBAAiB,sBAAuBb,GAAe,GACxDzB,SAASuC,cACjBvC,SAASuC,YAAY,sBAAuBd,GAC5CzB,SAASuC,YAAY,wBAAyBd,IAGhDA"}