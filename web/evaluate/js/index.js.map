{"version":3,"file":"/web/evaluate/js/index.js.map","sources":["/web/evaluate/js/index.js"],"sourcesContent":["$(function() {\n  FastClick.attach(document.body);\n  var $document = $(document),\n    $main = $('main'),\n    $ul = $main.find('ul'),\n    docHeight = $document.height(),\n    headerH = $('header').height(),\n    id = parse().id;\n    isloading = false,\n    OFFSET = 50,\n    page = 1,\n    total = 0;\n\n  loadData(page);\n\n  function handleData(result) {\n    if (result && $.isArray(result.data) && result.data.length > 0) {\n      var html = [],\n        data = result.data,\n        len = data.length;\n\n        for(var i = 0; i < len; i++) {\n          var li = ['<li>',\n            '<div class=\"head\">',\n              '<img src=\"./images/head-portrait.jpg\" />',\n              '<span>危言危行13***8</span>',\n            '</div>',\n            '<div class=\"evaluate\">裤子穿着挺舒服的，喜欢这种收腰设计的背带裤，就是个人觉得颜色有点太浅，要是稍微深点更完美！</div>',\n            '<p class=\"detail\">',\n              '<span>2018-10-02</span>',\n              '<span>颜色分类 : <em>蓝色</em></span>',\n              '<span>尺寸 : <em>L</em></span>',\n            '</p>',\n          '</li>'];\n          html.push(li.join(''));\n        }\n    \n        $ul.append(html.join(''));\n    }\n\n    if (result && $.isPlainObject(result.meta) && $.isPlainObject(result.meta.pagination)) {\n      total = result.meta.pagination.total;\n    }\n\n    isloading = false;\n  }\n  \n  // 加载列表\n  function loadData(pageNum) {\n    if (!id) {\n      return;\n    }\n\n    var param = {\n      page: pageNum || 1,\n      per_page: 6\n    };\n\n    $.ajax({\n      type: 'GET',\n      url: '/api/products/' + id + '/reviews',\n      data: param,\n      dataType: 'json',\n      timeout: 3000,\n      success: function(data){\n        console.log(data);\n        handleData(data);\n      }\n    });\n  }\n\n  // 滚动加载 \n  $main.off('scroll').on('scroll', function(e) {\n    if(isloading || total <= $ul.find('li').length) {\n      return;\n    }\n\n    var ulOffset = $ul.offset(),\n      ulHeight = ulOffset.height,\n      ulTop = -ulOffset.top,\n      sHeight = $main.scrollTop();\n\n    if (sHeight >= OFFSET) {\n      $backTop.addClass('faseIn');\n    } else {\n      $backTop.removeClass('faseIn');\n    }\n\n    if (ulHeight - OFFSET <= ulTop + docHeight) {\n      isloading = true;\n      console.log('滑到最底部了');\n      loadData(++page);\n    }\n  });\n  \n  $(document).on('unload', function() {\n    $main.off('scroll');\n  });\n\n  //返回\n  $('header i').on('click', function() {\n    history.go(-1);\n  });\n});"],"names":["$","handleData","result","isArray","data","length","html","len","i","li","push","join","$ul","append","isPlainObject","meta","pagination","total","isloading","loadData","pageNum","id","param","page","per_page","ajax","type","url","dataType","timeout","success","console","log","FastClick","attach","document","body","$document","$main","find","docHeight","height","parse","OFFSET","off","on","ulOffset","offset","ulHeight","ulTop","top","sHeight","scrollTop","$backTop","addClass","removeClass","history","go"],"mappings":"AAAAA,EAAE,WAeA,QAASC,GAAWC,GAClB,GAAIA,GAAUF,EAAEG,QAAQD,EAAOE,OAASF,EAAOE,KAAKC,OAAS,EAAG,CAK5D,IAAI,GAJFC,MACFF,EAAOF,EAAOE,KACdG,EAAMH,EAAKC,OAEHG,EAAI,EAAOD,EAAJC,EAASA,IAAK,CAC3B,GAAIC,IAAM,OACR,qBACE,2CACA,0BACF,SACA,4EACA,qBACE,0BACA,kCACA,+BACF,OACF,QACAH,GAAKI,KAAKD,EAAGE,KAAK,KAGpBC,EAAIC,OAAOP,EAAKK,KAAK,KAGrBT,GAAUF,EAAEc,cAAcZ,EAAOa,OAASf,EAAEc,cAAcZ,EAAOa,KAAKC,cACxEC,MAAQf,EAAOa,KAAKC,WAAWC,OAGjCC,WAAY,EAId,QAASC,GAASC,GAChB,GAAKC,EAAL,CAIA,GAAIC,IACFC,KAAMH,GAAW,EACjBI,SAAU,EAGZxB,GAAEyB,MACAC,KAAM,MACNC,IAAK,iBAAmBN,EAAK,WAC7BjB,KAAMkB,EACNM,SAAU,OACVC,QAAS,IACTC,QAAS,SAAS1B,GAChB2B,QAAQC,IAAI5B,GACZH,EAAWG,OAjEjB6B,UAAUC,OAAOC,SAASC,KAC1B,IAAIC,GAAYrC,EAAEmC,UAChBG,EAAQtC,EAAE,QACVY,EAAM0B,EAAMC,KAAK,MACjBC,EAAYH,EAAUI,SAEtBpB,GADUrB,EAAE,UAAUyC,SACjBC,QAAQrB,GACbH,YAAY,EACZyB,OAAS,GACTpB,KAAO,EACPN,MAAQ,EAEVE,EAASI,MA2DTe,EAAMM,IAAI,UAAUC,GAAG,SAAU,WAC/B,KAAG3B,WAAaD,OAASL,EAAI2B,KAAK,MAAMlC,QAAxC,CAIA,GAAIyC,GAAWlC,EAAImC,SACjBC,EAAWF,EAASL,OACpBQ,GAASH,EAASI,IAClBC,EAAUb,EAAMc,WAEdD,IAAWR,OACbU,SAASC,SAAS,UAElBD,SAASE,YAAY,UAGEN,EAAQT,GAA7BQ,EAAWL,SACbzB,WAAY,EACZa,QAAQC,IAAI,UACZb,IAAWI,UAIfvB,EAAEmC,UAAUU,GAAG,SAAU,WACvBP,EAAMM,IAAI,YAIZ5C,EAAE,YAAY6C,GAAG,QAAS,WACxBW,QAAQC,GAAG"}